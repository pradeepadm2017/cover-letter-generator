<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BatchApply - AI-Powered Cover Letter Generator</title>
    <link rel="stylesheet" href="landing-styles.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <img src="my-design-page-1.png" alt="FastCoverLetters" class="logo-full">
            </div>
            <div class="nav-links">
                <a href="#features">Features</a>
                <a href="#pricing">Pricing</a>
                <button onclick="showAuthModal()" class="btn-login">Login</button>
            </div>
        </div>
    </nav>

    <section class="hero">
        <div class="hero-content">
            <h1 class="hero-title">Create 20 Custom Cover Letters in 60 Seconds</h1>
            <p class="hero-subtitle">The job market is brutal‚Äîyou need 300+ applications to land an offer. Generate perfectly formatted, job-specific cover letters in bulk and apply faster than ever.</p>
            <div class="hero-stats">
                <div class="stat">
                    <div class="stat-number">20+</div>
                    <div class="stat-label">Cover letters per minute</div>
                </div>
                <div class="stat">
                    <div class="stat-number">10x</div>
                    <div class="stat-label">Faster than ChatGPT</div>
                </div>
                <div class="stat">
                    <div class="stat-number">100%</div>
                    <div class="stat-label">Formatted & ready</div>
                </div>
            </div>
            <div class="hero-cta">
                <button onclick="showAuthModal()" class="btn-primary btn-large">
                    Start Creating Free
                </button>
            </div>
            <p class="hero-note">‚úì 3 free cover letters ‚Ä¢ No credit card required</p>
        </div>
    </section>

    <section class="problem-solution">
        <div class="container">
            <h2>Stop Wasting Time on Repetitive Tasks</h2>
            <div class="comparison-grid">
                <div class="comparison-card old-way">
                    <h3>‚ùå The Old Way (ChatGPT)</h3>
                    <ul>
                        <li>Upload resume for each job</li>
                        <li>Copy & paste job description</li>
                        <li>Copy text into Word</li>
                        <li>Fix formatting issues</li>
                        <li>Save and rename file</li>
                        <li><strong>Repeat 20 times = 2+ hours</strong></li>
                    </ul>
                </div>
                <div class="comparison-card new-way">
                    <h3>‚úÖ Our Way</h3>
                    <ul>
                        <li>Upload resume once</li>
                        <li>Paste 20 job URLs</li>
                        <li>Click generate</li>
                        <li>Download 20 formatted docs</li>
                        <li><strong>Done in under 60 seconds</strong></li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <section class="how-it-works">
        <div class="container">
            <h2>How It Works</h2>
            <div class="steps-grid">
                <div class="step">
                    <div class="step-number">1</div>
                    <h3>Upload Your Resume</h3>
                    <p>Paste your resume text or upload a Word/TXT file once</p>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <h3>Add Job URLs</h3>
                    <p>Paste links from Indeed, LinkedIn, or any job posting site‚Äîas many as you want</p>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <h3>Click Generate</h3>
                    <p>AI analyzes each job posting and creates tailored cover letters in seconds</p>
                </div>
                <div class="step">
                    <div class="step-number">4</div>
                    <h3>Download & Apply</h3>
                    <p>Get perfectly formatted Word documents, named by job title‚Äîready to submit</p>
                </div>
            </div>
        </div>
    </section>

    <section id="features" class="features">
        <div class="container">
            <h2>Why Job Seekers Love FastCoverLetters</h2>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">‚ö°</div>
                    <h3>Batch Applications Made Easy</h3>
                    <p>Apply to 20 jobs in the time it used to take for one. Perfect for high-volume job searching.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üéØ</div>
                    <h3>Truly Customized Content</h3>
                    <p>AI analyzes each job posting and tailors your cover letter to match specific requirements and company culture.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üíæ</div>
                    <h3>Zero Formatting Hassle</h3>
                    <p>Download perfectly formatted Word documents‚Äîno copying, pasting, or fixing formatting errors.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üìù</div>
                    <h3>Smart File Naming</h3>
                    <p>Files automatically named by job title and company, so you know exactly which letter is for which job.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üîí</div>
                    <h3>Your Data Stays Private</h3>
                    <p>We don't store your resumes or cover letters. Generate and download‚Äîthat's it.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">‚ú®</div>
                    <h3>Powered by GPT-4</h3>
                    <p>The same AI you'd use manually, but automated to work with multiple jobs simultaneously.</p>
                </div>
            </div>
        </div>
    </section>

    <section id="pricing" class="pricing">
        <div class="container">
            <h2>Simple, Transparent Pricing</h2>
            <p class="pricing-subtitle">Choose the plan that works best for you</p>
            <div class="pricing-grid">
                <div class="pricing-card">
                    <div class="pricing-header">
                        <h3>Free</h3>
                        <div class="pricing-price">
                            <span class="price-amount">$0</span>
                            <span class="price-period">/month</span>
                        </div>
                    </div>
                    <ul class="pricing-features">
                        <li>‚úì 3 cover letters per month</li>
                        <li>‚úì AI-powered custom cover letters</li>
                        <li>‚úì Word document downloads</li>
                        <li>‚úì Standard support</li>
                    </ul>
                    <button onclick="showAuthModal()" class="btn-pricing">Get Started Free</button>
                </div>

                <div class="pricing-card">
                    <div class="pricing-header">
                        <h3>Monthly</h3>
                        <div class="pricing-price">
                            <span class="price-amount">$12</span>
                            <span class="price-period">/month</span>
                        </div>
                    </div>
                    <ul class="pricing-features">
                        <li>‚úì Unlimited cover letters</li>
                        <li>‚úì AI-powered custom cover letters</li>
                        <li>‚úì Word document downloads</li>
                        <li>‚úì Priority support</li>
                    </ul>
                    <button onclick="showAuthModal()" class="btn-pricing">Start Monthly</button>
                </div>

                <div class="pricing-card featured">
                    <div class="pricing-badge">Best Value</div>
                    <div class="pricing-header">
                        <h3>Quarterly</h3>
                        <div class="pricing-price">
                            <span class="price-amount">$24</span>
                            <span class="price-period">/3 months</span>
                        </div>
                        <div class="pricing-savings">Save 33%</div>
                    </div>
                    <ul class="pricing-features">
                        <li>‚úì Unlimited cover letters</li>
                        <li>‚úì AI-powered custom cover letters</li>
                        <li>‚úì Word document downloads</li>
                        <li>‚úì Priority support</li>
                    </ul>
                    <button onclick="showAuthModal()" class="btn-pricing btn-featured">Start Quarterly</button>
                </div>

                <div class="pricing-card">
                    <div class="pricing-badge best-value">Lifetime Access</div>
                    <div class="pricing-header">
                        <h3>Lifetime</h3>
                        <div class="pricing-price">
                            <span class="price-amount">$50</span>
                            <span class="price-period">one-time</span>
                        </div>
                        <div class="pricing-savings">Pay once, use forever</div>
                    </div>
                    <ul class="pricing-features">
                        <li>‚úì Unlimited cover letters</li>
                        <li>‚úì AI-powered custom cover letters</li>
                        <li>‚úì Word document downloads</li>
                        <li>‚úì Priority support</li>
                        <li>‚úì Lifetime access - no renewals</li>
                    </ul>
                    <button onclick="showAuthModal()" class="btn-pricing">Get Lifetime Access</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Authentication Modal -->
    <div id="auth-modal" class="auth-modal hidden">
        <div class="auth-modal-content">
            <button class="auth-modal-close" onclick="hideAuthModal()">&times;</button>

            <h2>Sign In / Sign Up</h2>
            <p class="auth-subtitle">We'll send you a magic link to sign in or create your account</p>

            <button onclick="signInWithGoogle()" class="btn-google">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/>
                    <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/>
                    <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/>
                    <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/>
                </svg>
                Continue with Google
            </button>

            <div class="auth-divider">
                <span>or</span>
            </div>

            <form onsubmit="handleMagicLinkAuth(event)">
                <div class="form-group">
                    <label for="auth-email">Email Address</label>
                    <input type="email" id="auth-email" required placeholder="your@email.com">
                </div>
                <div id="auth-error" class="auth-error hidden"></div>
                <div id="auth-success" class="auth-success hidden"></div>
                <button type="submit" class="btn-auth">Send Magic Link</button>
            </form>

            <p class="auth-note">No password needed! We'll email you a secure link to sign in.</p>
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>FastCoverLetters.com</h4>
                    <p>AI-powered cover letter generation</p>
                </div>
                <div class="footer-section">
                    <h4>Support</h4>
                    <p>üìû Phone: <a href="tel:+14313370047">431-337-0047</a></p>
                    <p>‚úâÔ∏è Email: <a href="mailto:pradeepadm2017@gmail.com">pradeepadm2017@gmail.com</a></p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 FastCoverLetters.com. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        // Initialize Supabase
        const SUPABASE_URL = 'https://igliqzsokxeknkiozkrj.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlnbGlxenNva3hla25raW96a3JqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk4MjYzNjcsImV4cCI6MjA3NTQwMjM2N30.NasThZulDuYEbRZiVsIXTMt2dLWRwtveY6_GPVULv98';

        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {
            auth: {
                persistSession: true,
                autoRefreshToken: true,
                detectSessionInUrl: true
            }
        });

        // Check if user is already logged in
        async function checkAuth() {
            // Check if we just logged out
            if (justLoggedOut) {
                console.log('Just logged out, skipping auth check permanently');
                return;
            }

            // Check if we're in logout mode via URL parameter
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('logout') === 'true') {
                console.log('Logout parameter detected, skipping auth check');
                return;
            }

            const { data: { session } } = await supabase.auth.getSession();
            console.log('checkAuth - Session:', session ? 'EXISTS' : 'NULL');
            if (session) {
                console.log('Session found, redirecting to app');
                window.location.href = '/app';
            } else {
                console.log('No session, staying on landing page');
            }
        }

        // Auth Modal Functions
        function showAuthModal() {
            document.getElementById('auth-modal').classList.remove('hidden');
        }

        function hideAuthModal() {
            document.getElementById('auth-modal').classList.add('hidden');
            // Clear messages and form
            document.getElementById('auth-error').classList.add('hidden');
            document.getElementById('auth-success').classList.add('hidden');
            document.getElementById('auth-email').value = '';
        }

        // Sign in with Google
        async function signInWithGoogle() {
            const { data, error } = await supabase.auth.signInWithOAuth({
                provider: 'google',
                options: {
                    redirectTo: window.location.origin + '/app',
                    queryParams: {
                        prompt: 'select_account'
                    }
                }
            });

            if (error) {
                console.error('Error signing in:', error);
                alert('Failed to sign in with Google. Please try again.');
            }
        }

        // Magic Link Authentication (passwordless)
        async function handleMagicLinkAuth(event) {
            event.preventDefault();

            const email = document.getElementById('auth-email').value;
            const errorDiv = document.getElementById('auth-error');
            const successDiv = document.getElementById('auth-success');

            try {
                const { data, error } = await supabase.auth.signInWithOtp({
                    email: email,
                    options: {
                        emailRedirectTo: window.location.origin + '/app'
                    }
                });

                if (error) {
                    throw error;
                }

                console.log('Magic link sent successfully');
                successDiv.textContent = 'Check your email! We\'ve sent you a magic link to sign in.';
                successDiv.classList.remove('hidden');
                errorDiv.classList.add('hidden');

                // Clear the email field
                document.getElementById('auth-email').value = '';

            } catch (error) {
                console.error('Magic link error:', error);
                errorDiv.textContent = error.message || 'Failed to send magic link. Please try again.';
                errorDiv.classList.remove('hidden');
                successDiv.classList.add('hidden');
            }
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('auth-modal');
            if (event.target === modal) {
                hideAuthModal();
            }
        }

        // Global flag to prevent auth checks after logout
        let justLoggedOut = false;

        // Check auth on page load (only if not in middle of logout)
        (async function() {
            // Check for logout URL parameter
            const urlParams = new URLSearchParams(window.location.search);
            const isLoggingOut = urlParams.get('logout') === 'true';

            console.log('=== LANDING PAGE LOADED ===');
            console.log('Current URL:', window.location.href);
            console.log('Logout parameter:', isLoggingOut);

            if (isLoggingOut) {
                // Set flag to prevent any future auth checks
                justLoggedOut = true;

                // Clear all storage and ensure logout is complete
                console.log('Logout detected, clearing all storage');

                // Clear all storage FIRST before signOut
                localStorage.clear();
                sessionStorage.clear();

                // Clear any remaining Supabase keys manually
                for (let i = localStorage.length - 1; i >= 0; i--) {
                    const key = localStorage.key(i);
                    if (key && key.startsWith('sb-')) {
                        localStorage.removeItem(key);
                    }
                }

                // Sign out from Supabase
                console.log('Calling supabase.auth.signOut()...');
                await supabase.auth.signOut({ scope: 'local' });
                console.log('SignOut completed');

                // Wait longer to ensure everything is cleared
                await new Promise(resolve => setTimeout(resolve, 500));

                // Check if session still exists
                const { data: { session } } = await supabase.auth.getSession();
                console.log('Session after signOut:', session ? 'STILL EXISTS!' : 'NULL (good)');

                // Remove logout parameter from URL WITHOUT triggering navigation
                window.history.replaceState({}, document.title, '/');

                console.log('Logout completed, all storage cleared, staying on landing page');
                console.log('justLoggedOut flag set to:', justLoggedOut);
            } else {
                console.log('No logout parameter, calling checkAuth()...');
                await checkAuth();
            }
        })();
    </script>
</body>
</html>
